<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiAppMinhasCompras.Views.ListaProduto"
             NavigationPage.HasNavigationBar="True"
             Title="Minhas Compras" 
             Background="{StaticResource Gray100}">
    
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Somar" Clicked="ToolbarItem_Clicked_1" />
        <ToolbarItem Text="Adicionar" Clicked="ToolbarItem_Clicked" />
    </ContentPage.ToolbarItems>
    
    <VerticalStackLayout>
        <Grid RowDefinitions="Auto, Auto" 
              ColumnDefinitions="Auto, Auto"
              Padding="10"
              ColumnSpacing="10"
              RowSpacing="10"
              VerticalOptions="Center"
              HorizontalOptions="Center">

            <Label Grid.Row="0" Grid.Column="0"
                   x:Name="lbl_boasvindas"
                   Text="Lista produto"  
                   HorizontalOptions="Center" 
                   FontSize="14"
                   TextColor="Black" />

        </Grid>

        <Frame BackgroundColor="{StaticResource Gray100}">
            <VerticalStackLayout HorizontalOptions="Center">

                <Image
                      Source="frente.png"
                      HeightRequest="185"
                      Aspect="AspectFit"
                      SemanticProperties.Description="dot net bot in a race car number eight" />
                
                <Label Text=" Produtos"
                       VerticalOptions="Center" 
                       HorizontalOptions="Center"
                       FontSize="28"
                       TextColor="Black"/>

                <SearchBar x:Name="txt_search" 
                           Placeholder="Busca Produto"
                           TextChanged="txt_search_TextChanged"/>
                
                <!-- Corrigido: Removido MenuItem do ViewCell, adicione MenuItem diretamente ao ListView.ItemTemplate -->
                <ListView x:Name="lst_produtos" ItemSelected="lst_produtos_ItemSelected">
                    <ListView.Header>
                        <Grid ColumnDefinitions="*, *, *, *, *">
                            <Label Grid.Column="0" Text="ID"/>
                            <Label Grid.Column="1" Text="Descricao"/>
                            <Label Grid.Column="2" Text="PreÃ§o"/>
                            <Label Grid.Column="3" Text="Qtd"/>
                            <Label Grid.Column="4" Text="Total"/>
                           
                        </Grid>
                    </ListView.Header>
                    
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <ViewCell>
                                <ViewCell.ContextActions>
                                    <MenuItem Text="Remover"
                                              Clicked="MenuItem_Clicked"
                                              CommandParameter="{Binding Id}" />
                                </ViewCell.ContextActions>
                                <Grid ColumnDefinitions="*, *, *, *, *">
                                    <Label Grid.Column="0" Text="{Binding Id}" />
                                    <Label Grid.Column="1" Text="{Binding Descricao}" />
                                    <Label Grid.Column="2" Text="{Binding Preco}" />
                                    <Label Grid.Column="3" Text="{Binding Quantidade}" />
                                    <Label Grid.Column="4" Text="{Binding Total}" />
                                   
                                </Grid>
                            </ViewCell>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

            </VerticalStackLayout>
        </Frame>
        <Grid ColumnDefinitions="*, *" >
            <Label Grid.Column="0" 
                   Text=" Total"
                    VerticalOptions="Center" 
                    HorizontalOptions="Center"
                    FontSize="28"
                    TextColor="Black"/>

            <Label Grid.Column="1"  
                   Text="somar"
                   x:Name="txt_Somar"
                    VerticalOptions="Center" 
                    HorizontalOptions="Center"
                    FontSize="28"
                    TextColor="Black"/>
        </Grid>
    </VerticalStackLayout>
    
</ContentPage>
   